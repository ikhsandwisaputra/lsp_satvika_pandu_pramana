<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="application_status_page" name="Status Pendaftaran">
        <t t-call="website.layout">
            <t t-set="title">Status Pendaftaran</t>
            <t t-set="head">
                <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
            </t>
            
            <style>
                :root {
                    --iso-navy: #0f172a;
                    --iso-gold: #d4af37;
                    --status-draft: #94a3b8;
                    --status-submitted: #f59e0b;
                    --status-verified: #22c55e;
                    --status-payment: #3b82f6;
                    --status-rejected: #ef4444;
                }
                
                .status-page { background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); min-height: 100vh; padding: 40px 0; }
                
                /* Header Card */
                .summary-card {
                    background: white;
                    border-radius: 16px;
                    box-shadow: 0 10px 40px rgba(15, 23, 42, 0.1);
                    overflow: hidden;
                }
                .summary-header {
                    background: linear-gradient(135deg, var(--iso-navy) 0%, #1e293b 100%);
                    color: white;
                    padding: 30px;
                }
                .summary-header h2 { margin: 0; font-weight: 700; }
                .summary-header .subtitle { color: #94a3b8; font-size: 0.9rem; }
                
                .summary-body { padding: 30px; }
                .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
                .info-item label { display: block; color: #64748b; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; }
                .info-item .value { font-size: 1.1rem; font-weight: 600; color: var(--iso-navy); }
                
                /* Status Badge */
                .status-badge {
                    display: inline-flex;
                    align-items: center;
                    gap: 6px;
                    padding: 8px 16px;
                    border-radius: 99px;
                    font-weight: 600;
                    font-size: 0.85rem;
                }
                .status-draft { background: #f1f5f9; color: #64748b; }
                .status-submitted { background: #fef3c7; color: #d97706; }
                .status-revision { background: #ffedd5; color: #ea580c; }
                .status-payment { background: #dbeafe; color: #2563eb; }
                .status-verified { background: #dcfce7; color: #16a34a; }
                .status-scheduled { background: #e9d5ff; color: #9333ea; }
                .status-rejected { background: #fee2e2; color: #dc2626; }
                
                /* Timeline */
                .timeline-card {
                    background: white;
                    border-radius: 16px;
                    box-shadow: 0 10px 40px rgba(15, 23, 42, 0.1);
                    padding: 30px;
                    margin-top: 24px;
                }
                .timeline-card h4 { color: var(--iso-navy); font-weight: 700; margin-bottom: 24px; }
                
                .timeline {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    padding: 20px 0;
                }
                .timeline::before {
                    content: '';
                    position: absolute;
                    top: 50%;
                    left: 0;
                    right: 0;
                    height: 4px;
                    background: #e2e8f0;
                    transform: translateY(-50%);
                    z-index: 1;
                }
                
                .timeline-step {
                    position: relative;
                    z-index: 2;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    flex: 1;
                }
                .timeline-dot {
                    width: 40px;
                    height: 40px;
                    border-radius: 50%;
                    background: #e2e8f0;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: #94a3b8;
                    font-size: 18px;
                    transition: all 0.3s ease;
                }
                .timeline-step.active .timeline-dot {
                    background: var(--iso-gold);
                    color: white;
                    box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.3);
                }
                .timeline-step.completed .timeline-dot {
                    background: #22c55e;
                    color: white;
                }
                .timeline-step.rejected .timeline-dot {
                    background: #ef4444;
                    color: white;
                }
                
                .timeline-label {
                    margin-top: 12px;
                    font-size: 0.8rem;
                    color: #64748b;
                    text-align: center;
                    font-weight: 500;
                }
                .timeline-step.active .timeline-label,
                .timeline-step.completed .timeline-label { color: var(--iso-navy); font-weight: 600; }
                
                /* Status Message */
                .status-message {
                    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                    border-left: 4px solid #f59e0b;
                    padding: 20px;
                    border-radius: 0 12px 12px 0;
                    margin-top: 24px;
                }
                .status-message.verified {
                    background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
                    border-left-color: #22c55e;
                }
                .status-message.rejected {
                    background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
                    border-left-color: #ef4444;
                }
                .status-message h5 { margin: 0 0 8px; font-weight: 700; }
                .status-message p { margin: 0; color: #475569; }
                
                /* Action Buttons */
                .action-buttons { margin-top: 30px; display: flex; gap: 12px; flex-wrap: wrap; }
                .btn-iso-gold { background: var(--iso-gold); color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; }
                .btn-iso-gold:hover { background: #c9a227; color: white; }
            </style>
            
            <div class="status-page">
                <div class="container" style="max-width: 900px;">
                    
                    <!-- Summary Card -->
                    <div class="summary-card">
                        <div class="summary-header">
                            <div class="d-flex justify-content-between align-items-start flex-wrap">
                                <div>
                                    <p class="subtitle mb-1">Pendaftaran Sertifikasi</p>
                                    <h2><t t-esc="user.partner_id.name"/></h2>
                                </div>
                                <div t-attf-class="status-badge status-#{application.state}">
                                    <span class="material-symbols-outlined" style="font-size: 16px;">
                                        <t t-if="application.state == 'draft'">edit_note</t>
                                        <t t-elif="application.state == 'submitted'">hourglass_top</t>
                                        <t t-elif="application.state == 'revision'">sync_problem</t>
                                        <t t-elif="application.state == 'payment'">payments</t>
                                        <t t-elif="application.state == 'verified'">verified</t>
                                        <t t-elif="application.state == 'rejected'">cancel</t>
                                        <t t-else="">info</t>
                                    </span>
                                    <t t-if="application.state == 'draft'">Draft</t>
                                    <t t-elif="application.state == 'submitted'">Menunggu Verifikasi</t>
                                    <t t-elif="application.state == 'revision'">Perlu Revisi</t>
                                    <t t-elif="application.state == 'payment'">Menunggu Pembayaran</t>
                                    <t t-elif="application.state == 'verified'">Terverifikasi</t>
                                    <t t-elif="application.state == 'scheduled'">Terjadwal</t>
                                    <t t-elif="application.state == 'rejected'">Ditolak</t>
                                    <t t-else=""><t t-esc="application.state"/></t>
                                </div>
                            </div>
                        </div>
                        
                        <div class="summary-body">
                            <div class="info-grid">
                                <div class="info-item">
                                    <label>NIK / Passport</label>
                                    <div class="value"><t t-esc="application.nik or '-'"/></div>
                                </div>
                                <div class="info-item">
                                    <label>Skema Sertifikasi</label>
                                    <div class="value">
                                        <t t-if="application.scheme == 'level1'">Coating Inspector Level 1</t>
                                        <t t-elif="application.scheme == 'level2'">Coating Inspector Level 2</t>
                                        <t t-else="">-</t>
                                    </div>
                                </div>
                                <div class="info-item">
                                    <label>Jenis Permohonan</label>
                                    <div class="value">
                                        <t t-if="application.application_type == 'new'">Sertifikasi Baru</t>
                                        <t t-elif="application.application_type == 'recert'">Resertifikasi</t>
                                        <t t-else="">-</t>
                                    </div>
                                </div>
                                <div class="info-item">
                                    <label>Tanggal Daftar</label>
                                    <div class="value"><t t-esc="application.create_date" t-options="{'widget': 'date'}"/></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Info Detail Card (Muncul jika sudah verified/scheduled) -->
                    <t t-if="application.state in ['verified', 'scheduled']">
                        <div class="summary-card mt-4">
                            <div class="summary-header" style="background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%); padding: 20px;">
                                <h4 style="margin: 0; font-weight: 600;">
                                    <span class="material-symbols-outlined align-middle mr-2" style="font-size: 22px;">info</span>
                                    Informasi Sertifikasi Anda
                                </h4>
                            </div>
                            <div class="summary-body">
                                <div class="info-grid">
                                    <!-- Info Skema -->
                                    <div class="info-item">
                                        <label>üéì Level Sertifikasi</label>
                                        <div class="value">
                                            <t t-if="application.scheme == 'level1'">Coating Inspector Level 1</t>
                                            <t t-elif="application.scheme == 'level2'">Coating Inspector Level 2</t>
                                            <t t-else="">-</t>
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <label>üìù Jenis Permohonan</label>
                                        <div class="value">
                                            <t t-if="application.application_type == 'new'">Sertifikasi Baru</t>
                                            <t t-elif="application.application_type == 'recert'">Resertifikasi</t>
                                            <t t-else="">-</t>
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <label>üí∞ Total Pembayaran</label>
                                        <div class="value">
                                            Rp <t t-esc="'{:,.0f}'.format(application.payment_amount).replace(',', '.')"/>
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <label>‚úÖ Status Pembayaran</label>
                                        <div class="value" style="color: #16a34a;">Lunas</div>
                                    </div>
                                </div>
                                
                                <!-- Info Jadwal (hanya tampil jika sudah scheduled) -->
                                <t t-if="application.state == 'scheduled'">
                                    <hr style="margin: 24px 0; border-color: #e2e8f0;"/>
                                    <h5 style="color: #7c3aed; font-weight: 600; margin-bottom: 16px;">
                                        <span class="material-symbols-outlined align-middle mr-1" style="font-size: 20px;">calendar_month</span>
                                        Jadwal Ujian Anda
                                    </h5>
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <label>üìÖ Tanggal Ujian</label>
                                            <div class="value">
                                                <t t-esc="application.exam_date" t-options="{'widget': 'date', 'format': 'dd MMMM yyyy'}"/>
                                            </div>
                                        </div>
                                        <div class="info-item">
                                            <label>‚è∞ Waktu</label>
                                            <div class="value"><t t-esc="application.exam_time or '-'"/></div>
                                        </div>
                                        <div class="info-item">
                                            <label>üìç Lokasi</label>
                                            <div class="value"><t t-esc="application.exam_location or '-'"/></div>
                                        </div>
                                        <div class="info-item">
                                            <label>üè¢ Ruangan</label>
                                            <div class="value"><t t-esc="application.exam_room or '-'"/></div>
                                        </div>
                                    </div>
                                    
                                    <!-- Catatan dari Admin -->
                                    <t t-if="application.exam_notes">
                                        <div class="alert alert-info mt-3" style="background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px;">
                                            <strong>üìù Catatan dari Admin:</strong>
                                            <p class="mb-0 mt-1" t-esc="application.exam_notes"/>
                                        </div>
                                    </t>
                                </t>
                                
                                <!-- Pesan menunggu jadwal (jika verified tapi belum scheduled) -->
                                <t t-if="application.state == 'verified'">
                                    <div class="alert alert-warning mt-3" style="background: #fef3c7; border: 1px solid #fcd34d; border-radius: 8px;">
                                        <strong>‚è≥ Menunggu Penjadwalan</strong>
                                        <p class="mb-0 mt-1">Admin sedang menyusun jadwal ujian Anda. Informasi jadwal akan ditampilkan di halaman ini setelah ditetapkan.</p>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </t>
                    
                    <!-- Timeline Card -->
                    <div class="timeline-card">
                        <h4>
                            <span class="material-symbols-outlined align-middle mr-2" style="color: var(--iso-gold);">timeline</span>
                            Timeline Status Pendaftaran
                        </h4>
                        
                        <div class="timeline">
                            <!-- Step 1: Terdaftar -->
                            <div t-attf-class="timeline-step #{application.state in ['submitted', 'verified', 'scheduled'] and 'completed' or (application.state == 'draft' and 'active' or '')}">
                                <div class="timeline-dot">
                                    <span class="material-symbols-outlined">edit_document</span>
                                </div>
                                <div class="timeline-label">Pengisian Form</div>
                            </div>
                            
                            <!-- Step 2: Submitted -->
                            <div t-attf-class="timeline-step #{application.state in ['verified', 'scheduled'] and 'completed' or (application.state == 'submitted' and 'active' or '')}">
                                <div class="timeline-dot">
                                    <span class="material-symbols-outlined">upload_file</span>
                                </div>
                                <div class="timeline-label">Berkas Dikirim</div>
                            </div>
                            
                            <!-- Step 3: Verifikasi -->
                            <div t-attf-class="timeline-step #{application.state in ['payment', 'verified', 'scheduled'] and 'completed' or (application.state == 'submitted' and 'active' or '')}">
                                <div class="timeline-dot">
                                    <span class="material-symbols-outlined">fact_check</span>
                                </div>
                                <div class="timeline-label">Verifikasi Admin</div>
                            </div>

                            <!-- Step 4: Pembayaran -->
                            <div t-attf-class="timeline-step #{application.state in ['verified', 'scheduled'] and 'completed' or (application.state == 'payment' and 'active' or '')}">
                                <div class="timeline-dot">
                                    <span class="material-symbols-outlined">payments</span>
                                </div>
                                <div class="timeline-label">Pembayaran</div>
                            </div>

                            
                            <!-- Step 5: Dijadwalkan -->
                            <div t-attf-class="timeline-step #{application.state == 'scheduled' and 'completed' or (application.state == 'verified' and 'active' or '')}">
                                <div class="timeline-dot">
                                    <span class="material-symbols-outlined">workspace_premium</span>
                                </div>
                                <div class="timeline-label">Dijadwalkan</div>
                            </div>
                        </div>
                        
                        <!-- Status Message -->
                        <t t-if="application.state == 'submitted'">
                            <div class="status-message">
                                <h5>‚è≥ Menunggu Verifikasi Admin</h5>
                                <p>Dokumen Anda sedang dalam proses verifikasi oleh tim kami. Kami akan menghubungi Anda jika ada dokumen yang perlu diperbaiki.</p>
                            </div>
                        </t>
                        <t t-elif="application.state == 'payment'">
                            <t t-if="application.payment_status == 'pending'">
                                <div class="status-message" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-left-color: #f59e0b;">
                                    <h5>‚è≥ Pembayaran Sedang Diverifikasi</h5>
                                    <p>Pembayaran Anda sedang dalam proses verifikasi oleh tim kami. Mohon tunggu konfirmasi dalam 1x24 jam kerja.</p>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="status-message" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-left-color: #2563eb;">
                                    <h5>üí≥ Menunggu Pembayaran</h5>
                                    <p>Dokumen telah diverifikasi. Silakan lakukan pembayaran untuk menyelesaikan pendaftaran.</p>
                                </div>
                            </t>
                        </t>
                        <t t-elif="application.state == 'revision'">
                            <div class="status-message" style="background: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%); border-left-color: #ea580c;">
                                <h5>‚ö†Ô∏è Dokumen Perlu Diperbaiki</h5>
                                <p><strong>Catatan Admin:</strong></p>
                                <p t-esc="application.admin_note or 'Silakan periksa kembali dokumen Anda.'"/>
                                <p class="mt-2 mb-0"><small>Silakan perbaiki dokumen sesuai catatan di atas, lalu submit ulang.</small></p>
                            </div>
                        </t>
                        <t t-elif="application.state == 'verified'">
                            <div class="status-message verified">
                                <h5>‚úÖ Pembayaran Diterima</h5>
                                <p>Pembayaran Anda sudah dikonfirmasi. Silakan tunggu informasi jadwal ujian yang akan dikirim oleh admin.</p>
                            </div>
                        </t>
                        <t t-elif="application.state == 'scheduled'">
                            <div class="status-message" style="background: linear-gradient(135deg, #e9d5ff 0%, #d8b4fe 100%); border-left-color: #9333ea;">
                                <h5>üìÖ Ujian Sudah Dijadwalkan!</h5>
                                <p>Selamat! Jadwal ujian Anda sudah ditetapkan. Pastikan hadir tepat waktu sesuai jadwal di bawah.</p>
                            </div>
                        </t>
                        <t t-elif="application.state == 'rejected'">
                            <div class="status-message rejected">
                                <h5>‚ùå Aplikasi Ditolak</h5>
                                <p><strong>Alasan:</strong></p>
                                <p t-esc="application.admin_note or 'Aplikasi Anda tidak memenuhi persyaratan.'"/>
                            </div>
                        </t>
                        <t t-elif="application.state == 'draft'">
                            <div class="status-message" style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); border-left-color: #64748b;">
                                <h5>üìù Form Belum Selesai</h5>
                                <p>Anda belum menyelesaikan pengisian form pendaftaran. Silakan lanjutkan untuk melengkapi data dan dokumen.</p>
                            </div>
                        </t>
                        
                        <!-- Action Buttons -->
                        <div class="action-buttons">
                            <t t-if="application.state == 'draft'">
                                <a href="/certification/apply" class="btn btn-iso-gold">
                                    <span class="material-symbols-outlined align-middle mr-1" style="font-size: 18px;">edit</span>
                                    Lanjutkan Pendaftaran
                                </a>
                            </t>
                            <t t-if="application.state == 'revision'">
                                <a href="/certification/apply?edit=1" class="btn btn-iso-gold">
                                    <span class="material-symbols-outlined align-middle mr-1" style="font-size: 18px;">edit_document</span>
                                    Perbaiki Dokumen
                                </a>
                            </t>
                            <t t-if="application.state == 'payment' and application.payment_status != 'pending'">
                                <a href="/certification/payment" class="btn btn-iso-gold">
                                    <span class="material-symbols-outlined align-middle mr-1" style="font-size: 18px;">credit_card</span>
                                    Bayar Sekarang
                                </a>
                            </t>
                            <a href="/my" class="btn btn-outline-secondary">
                                <span class="material-symbols-outlined align-middle mr-1" style="font-size: 18px;">home</span>
                                Kembali ke Portal
                            </a>
                        </div>
                    </div>
                    
                    <!-- Contact Info -->
                    <div class="text-center mt-4 text-muted">
                        <small>Ada pertanyaan? Hubungi kami di <strong>admin@lsp-coatinginspector.id</strong></small>
                    </div>
                    
                </div>
            </div>
            
        </t>
    </template>
</odoo>
